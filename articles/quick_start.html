<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quick start for targeted peak integration of LC-MS data using TARDIS • TARDIS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick start for targeted peak integration of LC-MS data using TARDIS">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TARDIS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/case_study.html">Case study: targeted metabolite detection using TARDIS in cardiovascular disease</a></li>
    <li><a class="dropdown-item" href="../articles/gui_tutorial.html">Targeted peak integration of LC-MS data using T.A.R.D.I.S.</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start.html">Quick start for targeted peak integration of LC-MS data using TARDIS</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quick start for targeted peak integration of LC-MS data using TARDIS</h1>
                        <h4 data-toc-skip class="author">Pablo
Vangeenderhuysen</h4>
            
            <h4 data-toc-skip class="date">2025-10-23</h4>
      

      <div class="d-none name"><code>quick_start.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>TARDIS</code> offers an easy and straightforward way to
automatically calculate area under the peak, max intensity and various
quality metrics for targeted chemical compounds in LC-MS data. It makes
use of an established retention time correction algorithm from the
<code>xcms</code> package and loads MS data as <code>Spectra</code>
objects so it’s easily integrated with other tools of the
<em>Rformassspectrometry</em> initiative.</p>
<p>See <a href="https://github.com/pablovgd/T.A.R.D.I.S./blob/main/README.md" class="external-link">README</a>
for installation instructions.</p>
<p>This quick start guide will briefly demonstrate the main
functionalities of <code>TARDIS</code> using the command line interface.
For details on the GUI we refer to the <code>gui_tutorial</code>
vignette. For more information we refer to the publication : <a href="https://pubs.acs.org/doi/10.1021/acs.analchem.5c00567" class="external-link uri">https://pubs.acs.org/doi/10.1021/acs.analchem.5c00567</a>.</p>
</div>
<div class="section level2">
<h2 id="loading-data">Loading data<a class="anchor" aria-label="anchor" href="#loading-data"></a>
</h2>
<p>The first step is creating a <code>data.frame</code> that describes
the chemical compounds. Following columns at least need to be present
for each compound:</p>
<ul>
<li>A compound ID, a unique identifier</li>
<li>A compound Name</li>
<li>Theoretical or measured <em>m/z</em>
</li>
<li>Expected RT (in minutes)</li>
<li>A column that indicates the polarity of the formed ion for that
compound</li>
</ul>
<p>Extra columns can be included in the file, but will be ignored by
<code>TARDIS</code> unless otherwise indicated.</p>
<p>An input file (either .xlsx or .csv) can be converted to a correct
data.frame using the <code><a href="../reference/createTargetList.html">createTargetList()</a></code> function. Input
parameters needed are: the path to the file, the patterns for positive
and negative ionization, the polarity of interest, the columnn that
contains the ionization mode and the other columns of interest.</p>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="left">name</th>
<th align="left">mz</th>
<th align="left">ion</th>
<th align="left">rt</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">49</td>
<td align="left">Valeric acid</td>
<td align="left">103.07536</td>
<td align="left">+</td>
<td align="left">8.4</td>
</tr>
<tr class="even">
<td align="right">76</td>
<td align="left">Malic acid</td>
<td align="left">133.01424</td>
<td align="left">-</td>
<td align="left">1.21</td>
</tr>
<tr class="odd">
<td align="right">82</td>
<td align="left">Pyruvic acid</td>
<td align="left">87.008769999999998</td>
<td align="left">-</td>
<td align="left">1.48</td>
</tr>
<tr class="even">
<td align="right">86</td>
<td align="left">(R)-(+)-Methylsuccinic acid</td>
<td align="left">133.04954000000001</td>
<td align="left">+</td>
<td align="left">4.2</td>
</tr>
<tr class="odd">
<td align="right">89</td>
<td align="left">Azelaic acid</td>
<td align="left">187.09757999999999</td>
<td align="left">-</td>
<td align="left">8.77</td>
</tr>
<tr class="even">
<td align="right">91</td>
<td align="left">Sebacic acid </td>
<td align="left">201.11322999999999</td>
<td align="left">-</td>
<td align="left">9</td>
</tr>
</tbody>
</table>
<p>The target <code>data.frame</code> is created using
<code><a href="../reference/createTargetList.html">createTargetList()</a></code>. For more info on how to use the
function, check the help page: <code><a href="../reference/createTargetList.html">?createTargetList</a></code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pablovgd.github.io/TARDIS/">TARDIS</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'S4Arrays::makeNindexFromArrayViewport' by</span></span>
<span><span class="co">#&gt; 'DelayedArray::makeNindexFromArrayViewport' when loading 'SummarizedExperiment'</span></span>
<span><span class="va">targets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createTargetList.html">createTargetList</a></span><span class="op">(</span><span class="st">"vignette_data/targets.xlsx"</span>,</span>
<span>                            pos_pattern <span class="op">=</span> <span class="st">"+"</span>,</span>
<span>                            neg_pattern <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>                            polarity <span class="op">=</span> <span class="st">"positive"</span>,</span>
<span>                            ion_column <span class="op">=</span> <span class="st">"ion"</span>,</span>
<span>                            columns_of_interest <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"name"</span>, <span class="st">"mz"</span>, <span class="st">"rt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">targets</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">ID</th>
<th align="left">NAME</th>
<th align="right">m/z</th>
<th align="right">tr</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">49</td>
<td align="left">Valeric acid</td>
<td align="right">103.07536</td>
<td align="right">504.0</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">86</td>
<td align="left">(R)-(+)-Methylsuccinic acid</td>
<td align="right">133.04954</td>
<td align="right">252.0</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">98</td>
<td align="left">Urocanic acid </td>
<td align="right">139.05020</td>
<td align="right">79.8</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">169</td>
<td align="left">L-Alanine</td>
<td align="right">90.05496</td>
<td align="right">51.6</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="left">170</td>
<td align="left">L-Valine</td>
<td align="right">118.08626</td>
<td align="right">78.0</td>
</tr>
<tr class="even">
<td align="left">11</td>
<td align="left">171</td>
<td align="left">L-Leucine</td>
<td align="right">132.10191</td>
<td align="right">132.0</td>
</tr>
</tbody>
</table>
<p>The files in which the targets need to be detected are:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"vignette_data/mzML/"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "230523s016_QC1_1.mzML" "230523s017_QC2_1.mzML" "230523s018_A081.mzML" </span></span>
<span><span class="co">#&gt;  [4] "230523s020_A254.mzML"  "230523s021_A158.mzML"  "230523s022_A521.mzML" </span></span>
<span><span class="co">#&gt;  [7] "230523s028_QC1_2.mzML" "230523s029_QC2_2.mzML" "230523s030_A043.mzML" </span></span>
<span><span class="co">#&gt; [10] "230523s031_A551.mzML"  "230523s032_A566.mzML"  "230523s033_A513.mzML" </span></span>
<span><span class="co">#&gt; [13] "230523s040_QC1_3.mzML" "230523s041_QC2_3.mzML"</span></span></code></pre></div>
<p>The files are ordered in the folder by injection index, in this case,
we have a total of 14 runs:two QC injections, followed by four sample
injections, two QC injections, four sample injections and two QC
injections.</p>
<p>Alternatively, instead of using file paths as input for TARDIS, the
user can also use an <code>MsExperiment</code> object. Here it is
necessary to include at least sample type in the sampleData to
distinguish QC from sample runs.</p>
<p><strong>IMPORTANT!</strong> The sampleData column has to be named
<code>type</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">MsExperiment</a></span><span class="op">)</span></span>
<span><span class="va">files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"vignette_data/mzML/"</span>,full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">ms_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/readMsExperiment.html" class="external-link">readMsExperiment</a></span><span class="op">(</span><span class="va">files</span>,</span>
<span>                            backend <span class="op">=</span> <span class="fu">Spectra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Spectra/man/MsBackend.html" class="external-link">MsBackendMzR</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ms_data</span></span>
<span><span class="co">#&gt; Object of class MsExperiment </span></span>
<span><span class="co">#&gt;  Spectra: MS1 (15625) </span></span>
<span><span class="co">#&gt;  Experiment data: 14 sample(s)</span></span>
<span><span class="co">#&gt;  Sample data links:</span></span>
<span><span class="co">#&gt;   - spectra: 14 sample(s) to 15625 element(s).</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/MsExperiment/man/MsExperiment.html" class="external-link">sampleData</a></span><span class="op">(</span><span class="va">ms_data</span><span class="op">)</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"QC"</span>,</span>
<span>              <span class="st">"QC"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"QC"</span>,</span>
<span>              <span class="st">"QC"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"sample"</span>,</span>
<span>              <span class="st">"QC"</span>,</span>
<span>              <span class="st">"QC"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-with-multiple-scan-windows">Data with multiple scan windows<a class="anchor" aria-label="anchor" href="#data-with-multiple-scan-windows"></a>
</h2>
<p><strong>IMPORTANT!</strong> if your data contains multiple
(overlapping) <em>m/z</em> scan windows, it is nescessary to analyze
these seperatly through the “mass_range” argument. If not, you will
notice that peaks will have a sawtooth profile, because of the filtering
of empty spectra within TARDIS.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="st">"vignette_data/plots/sawtooth.png"</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_data/plots/sawtooth.png" width="49%"></p>
</div>
<div class="section level2">
<h2 id="screening-mode">Screening mode<a class="anchor" aria-label="anchor" href="#screening-mode"></a>
</h2>
<p>First, we perform a screening step to check if our targets are
visible within our <em>m/z</em> and RT windows.</p>
<p>I limited the selection to 10 targets: 5 internal standards and 5
endogenous metabolites.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">targets</span> <span class="op">=</span> <span class="va">targets</span><span class="op">[</span><span class="va">targets</span><span class="op">$</span><span class="va">ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1576"</span>,<span class="st">"1577"</span>,<span class="st">"1578"</span>,<span class="st">"1583"</span>,<span class="st">"331"</span>,</span>
<span>                            <span class="st">"7"</span>,<span class="st">"9"</span>,<span class="st">"131"</span>,<span class="st">"179"</span>,<span class="st">"183"</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<p>We can run screening mode using the argument
<code>screening_mode = TRUE</code> in the tardis_peaks function.</p>
<p>For more details on the inputs of the function, please read the help
page <code><a href="../reference/tardisPeaks.html">?tardisPeaks</a></code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tardisPeaks.html">tardisPeaks</a></span><span class="op">(</span>file_path <span class="op">=</span> <span class="st">"vignette_data/mzML/"</span>,</span>
<span>                        dbData <span class="op">=</span> <span class="va">targets</span>,</span>
<span>                        mass_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                        polarity <span class="op">=</span> <span class="st">"positive"</span>,</span>
<span>                        output_directory <span class="op">=</span> <span class="st">"vignette_data/output/screening/"</span>,</span>
<span>                        batch_positions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        QC_pattern <span class="op">=</span> <span class="st">"QC"</span>,</span>
<span>                        int_std_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1576"</span>,<span class="st">"1577"</span>,<span class="st">"1578"</span>,<span class="st">"1583"</span>,<span class="st">"331"</span><span class="op">)</span>,</span>
<span>                        screening_mode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Performing retention time correction using 5 peak groups.</span></span></code></pre></div>
<p>Or, as mentioned, the MsExperiment object can be used as input
instead.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tardisPeaks.html">tardisPeaks</a></span><span class="op">(</span> lcmsData <span class="op">=</span> <span class="va">ms_data</span>, </span>
<span>                        dbData <span class="op">=</span> <span class="va">targets</span>,</span>
<span>                        mass_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                        polarity <span class="op">=</span> <span class="st">"positive"</span>,</span>
<span>                        output_directory <span class="op">=</span> <span class="st">"vignette_data/output/screening/"</span>,</span>
<span>                        batch_positions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        QC_pattern <span class="op">=</span> <span class="st">"QC"</span>,</span>
<span>                        int_std_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1576"</span>,<span class="st">"1577"</span>,<span class="st">"1578"</span>,<span class="st">"1583"</span>,<span class="st">"331"</span><span class="op">)</span>,</span>
<span>                        screening_mode <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Performing retention time correction using 5 peak groups.</span></span>
<span><span class="co">#&gt; Warning in .adjustRtime_peakGroupsMatrix(rt_raw, peakGroupsMatrix(param), :</span></span>
<span><span class="co">#&gt; Span too small for 'loess' and the available number of peak groups, resetting</span></span>
<span><span class="co">#&gt; to 0.8</span></span></code></pre></div>
<p>The resulting EICs are saved in the output folder and can be
inspected:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_7.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_9.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_131.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_179.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_183.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_331.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1576.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1577.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1578.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1583.png"</span></span>
<span>                         <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_7.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_9.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_131.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_179.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_183.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_331.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1576.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1577.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1578.png" width="49%"><img src="vignette_data/output/screening/Diagnostic_QCs_Batch_1/Component_1583.png" width="49%"></p>
<p>Based on the EICs we can see that detection and integration were
successful, however,targets 1577 and 1583 are eluting towards the edge
of our retention time windows, so we’ll adjust their expected retention
times to the ones were we see the peaks eluting.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">targets</span><span class="op">$</span><span class="va">tr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">targets</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1577</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">8.82</span> <span class="op">*</span> <span class="fl">60</span></span>
<span><span class="va">targets</span><span class="op">$</span><span class="va">tr</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">targets</span><span class="op">$</span><span class="va">ID</span> <span class="op">==</span> <span class="fl">1583</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="op">*</span> <span class="fl">60</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="peak-detection">Peak detection<a class="anchor" aria-label="anchor" href="#peak-detection"></a>
</h2>
<p>Now we can perform peak detection in all our runs by setting
<code>screening_mode =  FALSE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tardisPeaks.html">tardisPeaks</a></span><span class="op">(</span>lcmsData <span class="op">=</span> <span class="va">ms_data</span>,</span>
<span>                        dbData <span class="op">=</span> <span class="va">targets</span>,</span>
<span>                        mass_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                        polarity <span class="op">=</span> <span class="st">"positive"</span>,</span>
<span>                        output_directory <span class="op">=</span> <span class="st">"vignette_data/output/"</span>,</span>
<span>                        batch_positions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        QC_pattern <span class="op">=</span> <span class="st">"QC"</span>,</span>
<span>                        int_std_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1576"</span>,<span class="st">"1577"</span>,<span class="st">"1578"</span>,<span class="st">"1583"</span>,<span class="st">"331"</span><span class="op">)</span>,</span>
<span>                        screening_mode <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Performing retention time correction using 5 peak groups.</span></span>
<span><span class="co">#&gt; Aligning sample number 3 against subset ... OK</span></span>
<span><span class="co">#&gt; Aligning sample number 4 against subset ... OK</span></span>
<span><span class="co">#&gt; Aligning sample number 5 against subset ... OK</span></span>
<span><span class="co">#&gt; Aligning sample number 6 against subset ... OK</span></span>
<span><span class="co">#&gt; Aligning sample number 9 against subset ... OK</span></span>
<span><span class="co">#&gt; Aligning sample number 10 against subset ... OK</span></span>
<span><span class="co">#&gt; Aligning sample number 11 against subset ... OK</span></span>
<span><span class="co">#&gt; Aligning sample number 12 against subset ... OK</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>The resulting EICs are again saved in the output folder and can be
inspected:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html" class="external-link">include_graphics</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_7.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_9.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_131.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_179.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_183.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_331.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_1576.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_1577.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_1578.png"</span>,</span>
<span>                         <span class="st">"vignette_data/output/Diagnostic_QCs_Batch_1/Component_1583.png"</span></span>
<span>                         <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_7.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_9.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_131.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_179.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_183.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_331.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_1576.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_1577.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_1578.png" width="49%"><img src="vignette_data/output/Diagnostic_QCs_Batch_1/Component_1583.png" width="49%"></p>
<p>The <code>results</code> object is a <code>list</code> that contains
a <code>data.frame</code> with the AUC of each target in each run and a
<code>tibble</code> that contains a feature table with the average
metrics for each target in the QC runs.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="3%">
<col width="7%">
<col width="7%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="7%">
<col width="7%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="7%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="left">Component</th>
<th align="right">230523s016_QC1_1.mzML</th>
<th align="right">230523s017_QC2_1.mzML</th>
<th align="right">230523s018_A081.mzML</th>
<th align="right">230523s020_A254.mzML</th>
<th align="right">230523s021_A158.mzML</th>
<th align="right">230523s022_A521.mzML</th>
<th align="right">230523s028_QC1_2.mzML</th>
<th align="right">230523s029_QC2_2.mzML</th>
<th align="right">230523s030_A043.mzML</th>
<th align="right">230523s031_A551.mzML</th>
<th align="right">230523s032_A566.mzML</th>
<th align="right">230523s033_A513.mzML</th>
<th align="right">230523s040_QC1_3.mzML</th>
<th align="right">230523s041_QC2_3.mzML</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">131</td>
<td align="right">24020292</td>
<td align="right">28183111</td>
<td align="right">12404549</td>
<td align="right">28647263</td>
<td align="right">19778739</td>
<td align="right">15973261</td>
<td align="right">29269960</td>
<td align="right">27130309</td>
<td align="right">19605965</td>
<td align="right">65198737</td>
<td align="right">6319715</td>
<td align="right">5151537</td>
<td align="right">28820005</td>
<td align="right">28614613</td>
</tr>
<tr class="even">
<td align="left">1576</td>
<td align="right">8952766</td>
<td align="right">9009793</td>
<td align="right">10069135</td>
<td align="right">8740816</td>
<td align="right">9832668</td>
<td align="right">10029678</td>
<td align="right">8809010</td>
<td align="right">8410986</td>
<td align="right">8384713</td>
<td align="right">10408981</td>
<td align="right">9276249</td>
<td align="right">9122995</td>
<td align="right">9147050</td>
<td align="right">9265387</td>
</tr>
<tr class="odd">
<td align="left">1577</td>
<td align="right">31972288</td>
<td align="right">31621393</td>
<td align="right">33184503</td>
<td align="right">29541077</td>
<td align="right">36105805</td>
<td align="right">33162748</td>
<td align="right">31866205</td>
<td align="right">31143734</td>
<td align="right">28043811</td>
<td align="right">37897281</td>
<td align="right">28021253</td>
<td align="right">30422008</td>
<td align="right">31651442</td>
<td align="right">29564982</td>
</tr>
<tr class="even">
<td align="left">1578</td>
<td align="right">23234773</td>
<td align="right">24457534</td>
<td align="right">34549456</td>
<td align="right">30473747</td>
<td align="right">26068231</td>
<td align="right">28313704</td>
<td align="right">22667409</td>
<td align="right">23067483</td>
<td align="right">27788464</td>
<td align="right">34880113</td>
<td align="right">28988999</td>
<td align="right">28398306</td>
<td align="right">23927010</td>
<td align="right">22168021</td>
</tr>
<tr class="odd">
<td align="left">1583</td>
<td align="right">115889438</td>
<td align="right">112737670</td>
<td align="right">132212474</td>
<td align="right">125748268</td>
<td align="right">122671293</td>
<td align="right">130028353</td>
<td align="right">108772009</td>
<td align="right">112322858</td>
<td align="right">113154298</td>
<td align="right">129791199</td>
<td align="right">121465742</td>
<td align="right">79729532</td>
<td align="right">104780064</td>
<td align="right">109711464</td>
</tr>
<tr class="even">
<td align="left">179</td>
<td align="right">36945872</td>
<td align="right">38625629</td>
<td align="right">25433620</td>
<td align="right">9928833</td>
<td align="right">26196397</td>
<td align="right">25567778</td>
<td align="right">38382311</td>
<td align="right">35189159</td>
<td align="right">25537917</td>
<td align="right">22157571</td>
<td align="right">14137787</td>
<td align="right">16480727</td>
<td align="right">37429063</td>
<td align="right">37541661</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="7%">
<col width="6%">
<col width="7%">
<col width="7%">
<col width="7%">
<col width="7%">
<col width="3%">
<col width="17%">
<col width="6%">
<col width="7%">
<col width="7%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">Component</th>
<th align="right">AUC</th>
<th align="right">MaxInt</th>
<th align="right">SNR</th>
<th align="right">peak_cor</th>
<th align="right">foundRT</th>
<th align="right">pop</th>
<th align="left">ID</th>
<th align="left">NAME</th>
<th align="right">m.z</th>
<th align="right">tr</th>
<th align="right">mean</th>
<th align="left">na.rm</th>
<th align="right">trold</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">131</td>
<td align="right">27673048</td>
<td align="right">7013989</td>
<td align="right">8.549146</td>
<td align="right">0.9426621</td>
<td align="right">52.85621</td>
<td align="right">13.000000</td>
<td align="left">131</td>
<td align="left">D-(+)-Glucose</td>
<td align="right">203.0526</td>
<td align="right">52.85621</td>
<td align="right">52.85621</td>
<td align="left">TRUE</td>
<td align="right">54.6</td>
</tr>
<tr class="even">
<td align="left">1576</td>
<td align="right">8932499</td>
<td align="right">2052563</td>
<td align="right">9.639474</td>
<td align="right">0.9591649</td>
<td align="right">111.99854</td>
<td align="right">14.166667</td>
<td align="left">1576</td>
<td align="left">L-Tyrosine-d2</td>
<td align="right">184.0937</td>
<td align="right">111.99854</td>
<td align="right">111.99854</td>
<td align="left">TRUE</td>
<td align="right">109.2</td>
</tr>
<tr class="odd">
<td align="left">1577</td>
<td align="right">31303341</td>
<td align="right">9601707</td>
<td align="right">5.337986</td>
<td align="right">0.9473591</td>
<td align="right">529.66261</td>
<td align="right">7.666667</td>
<td align="left">1577</td>
<td align="left">Indole-3-acetic acid-d5</td>
<td align="right">181.1020</td>
<td align="right">529.66261</td>
<td align="right">529.66261</td>
<td align="left">TRUE</td>
<td align="right">529.2</td>
</tr>
<tr class="even">
<td align="left">1578</td>
<td align="right">23253705</td>
<td align="right">6981963</td>
<td align="right">8.124268</td>
<td align="right">0.9759577</td>
<td align="right">89.14154</td>
<td align="right">8.333333</td>
<td align="left">1578</td>
<td align="left">Dopamine-d4</td>
<td align="right">158.1111</td>
<td align="right">89.14154</td>
<td align="right">89.14154</td>
<td align="left">TRUE</td>
<td align="right">88.2</td>
</tr>
<tr class="odd">
<td align="left">1583</td>
<td align="right">110702250</td>
<td align="right">30890172</td>
<td align="right">11.890113</td>
<td align="right">0.9755802</td>
<td align="right">240.41981</td>
<td align="right">10.666667</td>
<td align="left">1583</td>
<td align="left">L-Phenylalanine-d2</td>
<td align="right">168.0988</td>
<td align="right">240.41981</td>
<td align="right">240.41981</td>
<td align="left">TRUE</td>
<td align="right">240.0</td>
</tr>
<tr class="even">
<td align="left">179</td>
<td align="right">37352282</td>
<td align="right">8723543</td>
<td align="right">8.876178</td>
<td align="right">0.9572953</td>
<td align="right">53.16109</td>
<td align="right">14.500000</td>
<td align="left">179</td>
<td align="left">L-Glutamic acid</td>
<td align="right">148.0604</td>
<td align="right">53.16109</td>
<td align="right">53.16109</td>
<td align="left">TRUE</td>
<td align="right">52.8</td>
</tr>
</tbody>
</table>
<p>Other results include tables with the other metrics (Max. Int., SNR,
peak_cor and points over the peak) and are saved into the output
folder.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maxint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"vignette_data/output/int_table.csv"</span>,check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">SNR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"vignette_data/output/snr_table.csv"</span>,check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">peak_cor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"vignette_data/output/peakcor_table.csv"</span>,check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">pop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"vignette_data/output/pop_table.csv"</span>,check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kableExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="0%">
<col width="3%">
<col width="7%">
<col width="7%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="7%">
<col width="7%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="6%">
<col width="7%">
<col width="7%">
</colgroup>
<thead><tr class="header">
<th align="right"></th>
<th align="right">Component</th>
<th align="right">230523s016_QC1_1.mzML</th>
<th align="right">230523s017_QC2_1.mzML</th>
<th align="right">230523s018_A081.mzML</th>
<th align="right">230523s020_A254.mzML</th>
<th align="right">230523s021_A158.mzML</th>
<th align="right">230523s022_A521.mzML</th>
<th align="right">230523s028_QC1_2.mzML</th>
<th align="right">230523s029_QC2_2.mzML</th>
<th align="right">230523s030_A043.mzML</th>
<th align="right">230523s031_A551.mzML</th>
<th align="right">230523s032_A566.mzML</th>
<th align="right">230523s033_A513.mzML</th>
<th align="right">230523s040_QC1_3.mzML</th>
<th align="right">230523s041_QC2_3.mzML</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">131</td>
<td align="right">9</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">8</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">13</td>
<td align="right">14</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1576</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">12</td>
<td align="right">13</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">18</td>
<td align="right">14</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1577</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">8</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1578</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1583</td>
<td align="right">9</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">14</td>
<td align="right">9</td>
<td align="right">11</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">11</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">9</td>
<td align="right">14</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">179</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">16</td>
<td align="right">16</td>
<td align="right">15</td>
<td align="right">15</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">14</td>
<td align="right">12</td>
<td align="right">14</td>
<td align="right">14</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pablo Vangeenderhuysen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
